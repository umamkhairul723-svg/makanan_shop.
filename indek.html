<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Layanan Pesanan Online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body { background-color: #f8f9fa; }
    .card-img-top { height: 180px; object-fit: cover; }
    footer { background: #0d6efd; color: white; padding: 15px; text-align: center; }
    .offcanvas-body img { border-radius: 8px; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">PesanOnline</a>
      <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#cartPanel">
        <i class="fa fa-shopping-cart"></i> Keranjang
        <span id="cart-count" class="badge bg-danger">0</span>
      </button>
    </div>
  </nav>

  <!-- Daftar Produk -->
  <div class="container my-4">
    <h3 class="mb-4 text-center fw-bold">Pilih Produk Anda</h3>
    <div class="row" id="product-list"></div>
  </div>

  <!-- Offcanvas Keranjang -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="cartPanel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Keranjang Belanja</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column">
      <div id="cart-items" class="flex-grow-1"></div>
      <hr>
      <div class="d-flex justify-content-between">
        <strong>Total:</strong> <span id="cart-total">Rp0</span>
      </div>
      <div class="mt-3 d-grid">
        <button class="btn btn-success" id="checkout-btn">Checkout</button>
        <button class="btn btn-outline-danger mt-2" id="clear-cart-btn">Kosongkan</button>
      </div>
    </div>
  </div>

  <!-- Modal Checkout -->
  <div class="modal fade" id="checkoutModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <form id="checkout-form">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Form Checkout</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div id="checkout-summary" class="mb-3"></div>
            <div class="mb-3">
              <label class="form-label">Nama Lengkap</label>
              <input type="text" class="form-control" id="nama" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Alamat Pengiriman</label>
              <textarea class="form-control" id="alamat" rows="3" required></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Nomor HP</label>
              <input type="tel" class="form-control" id="telepon" required>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-success">Konfirmasi Pesanan</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <footer>
    <p class="mb-0">Â© 2025 PesanOnline â€” Dibuat untuk Tugas Aplikasi Layanan Pesanan Online</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const PRODUCTS = [
  { id: 1, name: "Nasi Goreng Spesial", price: 25000, img:src="nasek.png" },
  { id: 2, name: "Mie Ayam Jumbo", price: 20000, img: src="mie jumbo.jpg"},
  { id: 3, name: "Burger Keju", price: 30000, img:src="buger.jpg"},
  { id: 4, name: "Es Teh Manis", price: 8000, img:src="es teh manis.jpg" }
];



    let cart = JSON.parse(localStorage.getItem("cart") || "{}");

    function formatRupiah(num) {
      return "Rp" + num.toLocaleString("id-ID");
    }

    function renderProducts() {
      const list = document.getElementById("product-list");
      list.innerHTML = "";
      PRODUCTS.forEach(p => {
        const col = document.createElement("div");
        col.className = "col-md-3 mb-4";
        col.innerHTML = `
          <div class="card h-100 shadow-sm">
            <img src="${p.img}" class="card-img-top" alt="${p.name}">
            <div class="card-body d-flex flex-column">
              <h5>${p.name}</h5>
              <p class="text-muted mb-2">${formatRupiah(p.price)}</p>
              <div class="mt-auto">
                <div class="input-group input-group-sm mb-2">
                  <button class="btn btn-outline-secondary" onclick="changeQty(${p.id}, -1)">-</button>
                  <input type="number" min="1" id="qty-${p.id}" value="1" class="form-control text-center">
                  <button class="btn btn-outline-secondary" onclick="changeQty(${p.id}, 1)">+</button>
                </div>
                <button class="btn btn-primary w-100" onclick="addToCart(${p.id})"><i class="fa fa-cart-plus"></i> Tambah</button>
              </div>
            </div>
          </div>`;
        list.appendChild(col);
      });
    }

    function changeQty(id, delta) {
      const input = document.getElementById("qty-" + id);
      let val = parseInt(input.value) + delta;
      if (val < 1) val = 1;
      input.value = val;
    }

    function addToCart(id) {
      const qty = parseInt(document.getElementById("qty-" + id).value);
      if (!cart[id]) cart[id] = 0;
      cart[id] += qty;
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCartUI();
      alert("Produk ditambahkan ke keranjang!");
    }

    function updateCartUI() {
      const itemsContainer = document.getElementById("cart-items");
      const totalElement = document.getElementById("cart-total");
      const countElement = document.getElementById("cart-count");

      itemsContainer.innerHTML = "";
      let total = 0, count = 0;

      for (const id in cart) {
        const product = PRODUCTS.find(p => p.id == id);
        const subtotal = cart[id] * product.price;
        total += subtotal;
        count += cart[id];
        itemsContainer.innerHTML += `
          <div class="d-flex align-items-center justify-content-between mb-3">
            <div class="d-flex align-items-center">
              <img src="${product.img}" alt="${product.name}" width="60" height="50">
              <div class="ms-2">
                <strong>${product.name}</strong><br>
                <small>${cart[id]} x ${formatRupiah(product.price)}</small>
              </div>
            </div>
            <div>
              <span>${formatRupiah(subtotal)}</span>
              <button class="btn btn-sm btn-link text-danger" onclick="removeFromCart(${id})"><i class="fa fa-trash"></i></button>
            </div>
          </div>`;
      }

      if (count === 0) {
        itemsContainer.innerHTML = "<p class='text-muted'>Keranjang kosong</p>";
      }

      totalElement.textContent = formatRupiah(total);
      countElement.textContent = count;
    }

    function removeFromCart(id) {
      delete cart[id];
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCartUI();
    }

    function clearCart() {
      cart = {};
      localStorage.setItem("cart", "{}");
      updateCartUI();
    }

    document.getElementById("checkout-btn").addEventListener("click", () => {
      if (Object.keys(cart).length === 0) {
        alert("Keranjang masih kosong!");
        return;
      }
      const summary = document.getElementById("checkout-summary");
      summary.innerHTML = "";
      let total = 0;
      for (const id in cart) {
        const p = PRODUCTS.find(pr => pr.id == id);
        const subtotal = p.price * cart[id];
        total += subtotal;
        summary.innerHTML += `
          <div class="d-flex justify-content-between">
            <span>${p.name} (${cart[id]}x)</span>
            <span>${formatRupiah(subtotal)}</span>
          </div>`;
      }
      summary.innerHTML += `<hr><div class="d-flex justify-content-between fw-bold"><span>Total</span><span>${formatRupiah(total)}</span></div>`;

      new bootstrap.Modal(document.getElementById("checkoutModal")).show();
    });

    document.getElementById("checkout-form").addEventListener("submit", e => {
      e.preventDefault();
      alert("Pesanan Anda berhasil disimpan!\nTerima kasih sudah berbelanja ðŸ˜Š");
      clearCart();
      bootstrap.Modal.getInstance(document.getElementById("checkoutModal")).hide();
    });

    document.getElementById("clear-cart-btn").addEventListener("click", () => {
      if (confirm("Kosongkan seluruh keranjang?")) clearCart();
    });

    renderProducts();
    updateCartUI();
  </script>
</body>
</html>
